# 6\. 架构风险与缓解策略

## 6.1. 风险：双存储数据同步失败

  * **潜在问题**: 离线索引时，图谱存储和向量存储的写入任务可能只有一个成功，导致数据状态不一致。
  * **架构缓解策略**: 采用“**暂存与发布 (Staging & Promotion)**”机制。离线管道先将数据写入临时目录，只有当所有写入任务都成功完成后，再通过一个原子操作将其更新为生产数据。

## 6.2. 风险：实时PPR算法的性能瓶颈

  * **潜在问题**: 在图谱规模和密度增大后，实时PPR计算可能成为查询时的性能瓶颈。
  * **架构缓解策略**: 引入**离线预计算与缓存**。对于PPR计算，可以在离线阶段为重要节点预先计算好Top N关联实体并缓存。在线查询时优先查找缓存。

## 6.3. 风险：适配器模式的脆弱性

  * **潜在问题**: 核心架构假设`hipporag`有清晰的接口可供“注入”我们自己的适配器。
  * **架构缓解策略**: 将开发计划的第一个故事设置为“**技术验证故事 (Spike Story)**”，其唯一目标就是编写最小测试代码，验证将一个自定义模块注入`hipporag`的可行性，从而在项目早期验证核心架构假设。